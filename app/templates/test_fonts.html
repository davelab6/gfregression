{% extends "base.html" %}
{% block head %}
  {{ super() }}
  <style>
    /*Load local fonts*/
    {% for font in fonts_after %}
      @font-face{
        font-family: {{ font.css_name }};
        font-style: {{ font.css_style }};
        font-weight: {{ font.css_weight }};
        src: url('{{ font.csspath }}');
      }
    {% endfor %}

    /*Load remote fonts*/
    {% for font in fonts_before %}
      @font-face{
        font-family: {{ font.css_name }};
        font-style: {{ font.css_style }};
        font-weight: {{ font.css_weight }};
        src: url('{{ font.csspath }}');
      }
    {% endfor %}

    /*Create classes for local fonts*/
    {% for font in fonts_after %}
      .{{ font.css_class }}{
        font-family: {{ font.css_name }};
        font-style: {{ font.css_style }};
        font-weight: {{ font.css_weight }};
      }
    {% endfor %}

    /*Create classes for fonts_before*/
    {% for font in fonts_before %}
      .{{ font.css_class }}{
        font-family: {{ font.css_name }};
        font-style: {{ font.css_style }};
        font-weight: {{ font.css_weight }};
      }
    {% endfor %}
  </style>
{% endblock %}

{% block content %}
  <meta id="to_fonts_after" data-name="fonts-after" data-str="{{ to_fonts_after }}">
  <meta id="to_fonts_before" data-name="fonts-before" data-str="{{ to_fonts_before }}">

  {% include "page-vertical-metrics.html" %}
  {% include "page-glyphs-modified.html" %}
  {% include "page-glyphs-new.html" %}
  {% include "page-glyphs-missing.html" %}
  {% include "page-waterfall.html" %}
  {% include "page-editor.html" %}

<script>
  after_str = $('#to_fonts_after').data();
  fonts_after = after_str['str'].split(',') 

  before_str = $('#to_fonts_before').data();
  fonts_before = before_str['str'].split(',');

  $('#info-button').on('click', function(){
    $('#info').toggle();
    $('.dropdown').hide();
  })
  ee = true;
  $('#font-toggle-button').on('click', function(){
    if(ee == false) {
      for (i in fonts_after) {
        $('.font-swap ' + '.' + fonts_after[i]).attr('class', fonts_before[i])
        $('.box-header > p').each(function() {
            text = $(this).text();
            $(this).text(text.replace('After', 'Before'));
        })
        console.log('changed to base');
      }
      ee = true;
    } else {
      for (i in fonts_before) {
        $('.font-swap ' + '.' + fonts_before[i]).attr('class', fonts_after[i])
        $('.box-header > p').each(function() {
            text = $(this).text();
            $(this).text(text.replace('Before', 'After'));

        })
        console.log('changed to target');
      }
      ee = false;
    }
    $('.dropdown').hide();
  })


  $('.container-button').on('click', function() {
    $('.pages').hide();
    $('.info').hide();
    var page = '#' + $(this).data('page')
    var infopanel = '#' + $(this).data('info')
    $(page).show()
    $(infopanel).show()
  })

  // Editor slider toggle
  $('[id*=sl]').on('input', function(){
    text_box = $(this).prop('id').replace("sl", "textbox");
    text_size = $(this).prop('id').replace("sl", "textsize");
    $('#' + text_box).css('font-size', $(this)[0].value + 'px');
    $('#' + text_size).html($(this)[0].value + 'px');
  })

  $('[id*=hide]').on('click', function(){
    text_box = $(this).prop('id').replace("hide", "textbox");
    $('#' + text_box).toggle();
    if ($(this).text() == 'remove_circle_outline') {
      $(this).html("add_circle_outline");
    } else {
      $(this).html("remove_circle_outline")
    }

  })

</script>
{% endblock %}
